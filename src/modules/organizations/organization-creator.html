<!DOCTYPE html>
<html lang="en">

  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="icon" href="https://cdn.cocreate.app/favicon.ico" type="image/ico" sizes="32x32">
    <title>Organiztion Creator | CoCreate</title>

		<!-- CoCreate CSS -->
		<link rel="stylesheet" href="https://cdn.cocreate.app/latest/CoCreate.min.css" type="text/css"/>

		<!-- Font Awesome -->
		<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.13.0/css/all.min.css" crossorigin="anonymous" />    

   </head>
    
  <style>
  	.speech-bubble:after { content: ''; position: absolute; top: 0; left: 50%; width: 0; height: 0; border: 23px solid transparent; border-bottom-color: #ffffff; border-top: 0; margin-left: -23px; margin-top: -23px;}
	</style>

  <body style='background-image: url("https://cdn.cocreate.app/background.png");'>
  	<a href="index.html" target="" class="sessionTrue hidden"></a>

	  <a href="index.html" title="" class="position:relative z-index:1 float:right margin:15px color:white dashboardLink">Dashboard</a>

    <div class="main-container justify-content:center align-items:center overflow:overlay display:flex flex-wrap:wrap position:absolute width:100% height:100%">
    	<div class="display:flex flex-wrap:wrap align-items:flex-end justify-content:center align-items:center">
        <div class="flex-grow:1 height:fit-content width:55% min-width:300px max-width:600px margin:10px">
        	<img src="https://cdn.cocreate.app/Preloader_2.gif" class="display:block margin:auto-lr margin:20px_0px">

        	<hgroup class="speech-bubble position:relative background:white border-radius:4px padding:15px">
            <div class="color:blue font-size:24px">
            	<p id="ava1">
            		Hey, <span data-document_id="" name="name" class="sessionUser_Id" data-collection="users">First Name</span>!
                    Enter your new organization's name. Don't worry if you are not sure, you can allways update it later.
            	</p>
             	<p id="ava2" class="hidden">
            		Great, <span data-document_id="" name="name" class="sessionUser_Id" data-collection="users">First Name</span>!
                	Letâ€™s choose an industry so I can begin to understand what we will be doing.
            	</p>
							<p id="ava3" class="hidden">
            		I could do special animations to impress you. But instead I will build your organization instantly and impress you with my speed!
            	</p>
            </div>
	        </hgroup>
        </div>
           
        <div class="flex-grow:1 height:fit-content width:35% min-width:300px max-width:400px margin:10px">
          <form  data-realtime="false">
                		
						<div id="step1">
	            <div class="overflow:hidden padding:0px_25px background:white">
								<div class="float:left width:75% padding-top:25px">
									<h3>Step 1 / 3</h3>
								</div>
	              <div class="float:right width:25% padding-top:5px font-size:70px line-height:100px text-align:right color:very-light-gray">
									<i class="fas fa-store"></i>
								</div>
						    </div>
						    <div class="padding:25px background:gainsboro text-align:left">
						    	<input type="text" id="org-name"
						    		data-collection="organizations"
						    		data-document_id=""  
						    		name="name" 
						    		placeholder="Organization Name" 
						    		class="floating-label">

						        <button type="button" class="outline" data-show='#step2,#ava2' data-hide='#step1,#ava1'>Next</button>
						    </div>
						</div>
						
            <div id="step2"  class="hidden">
            	<div class="overflow:hidden padding:0px_25px background:white">
								<div class="float:left width:75% padding-top:25px">
            			<h3>Step 2 / 3</h3>
            		</div>
            		<div class="float:right width:25% padding-top:5px font-size:70px line-height:100px text-align:right color:very-light-gray">
            			<i class="fas fa-industry"></i>
            		</div>
              </div>
              <div class="padding:25px background:gainsboro text-align:left">

               <!-- Industry select -->
                <cocreate-select class="sortable floating-label" 
                    data-collection="organizations" 
                    data-document_id=""
                    name="industry" 
                    placeholder="Industry">
  	          	  <input class="template-search" placeholder="Search" data-template_id="template1">
  								<ul data-fetch_collection="industries" 
  								    data-template_id="template1" 
  								    data-pass_to="me1234" 
  								    class="template-wrapper options overflow:overlay">
  									<li class="template option" data-pass_id="me1234">
  										<h5 data-collection="industries" data-document_id="" name="industry_name" data-pass_id="me1234">industry name</h5>
  									</li>
  								</ul>
                </cocreate-select>
															
                <button type="button" class="outline white-blue" data-show='#step1,#ava1' data-hide='#step2,#ava2'>Previous</button>
                <button type="button" class="outline" data-show='#step3,#ava3' data-hide='#step2,#ava2'>Next</button>
              </div>
            </div>

						<div id="step3" class="hidden">
              <div class="overflow:hidden padding:0px_25px background:white">
								<div class="float:left width:75% padding-top:25px">
									<h3>Step 3 / 3</h3>
								</div>
	              <div class="float:right width:25% padding-top:5px font-size:70px line-height:100px text-align:right color:very-light-gray">
									<i class="fa fa-key"></i>
								</div>
							</div>
							<div class="padding:25px background:gainsboro text-align:left">

								<!-- API key  -->
								<input type="hidden" id="apiKey"
									data-collection="organizations"
									data-document_id=""
									name="apiKey"  
									placeholder="API Key" 
									data-uuid="32" readonly>
								
								<!-- Security key  -->
								<input type="hidden" id="securityKey"
									data-collection="organizations"
									data-document_id=""  
									name="securityKey"  
									placeholder="security Key" 
									data-uuid="32" readonly>
									
								<button type="button" class="outline white-blue" data-show='#step2,#ava2' data-hide='#step3,#ava3'>Previous</button>
								<button type="button" class="outline red-white registerBtn industryBtn"><a href="index.html">Launch</a></button>
								
							</div>
						</div>
					</form>

        </div>
        
      </div>
    </div>

    <script>
    	var config = {
    	  apiKey: 'c2b08663-06e3-440c-ef6f-13978b42883a',
    	  organization_Id: '5de0387b12e200ea63204d6c'
    	}
    </script>
    
    <!--CoCreateJS-->
    <script Src="https://cdn.cocreate.app/latest/CoCreate.min.js"></script>

    <script>
    	localStorage.removeItem('organization_id');
      localStorage.removeItem('apiKey');
      localStorage.removeItem('securityKey');
    </script>
    
    <script>
      
      var getCurrentOrgForDashboardLink = false;
    
      let dashboardLink = document.querySelector(".dashboardLink");
      
      dashboardLink.addEventListener('click', function(e) {
        e.preventDefault();
        
        let userId = localStorage.getItem('userId');
        
        getCurrentOrg(userId);
        
        var timer = setInterval(function() {
          if (getOrg) {
            if (getCurrentOrgForDashboardLink) {
              let href = dashboardLink.getAttribute('href');
              
              document.location.href = href;
              
              clearInterval(timer);
            }
          }
        }, 100)
      })
      
      socket.on('usersCurrentOrg', function(data) {
        console.log(data);
        
        getCurrentOrgForDashboardLink = true;
        
        localStorage.setItem('apiKey', data['apiKey']);
        localStorage.setItem('securityKey', data['securityKey']);
        localStorage.setItem('organization_id', data['current_org']);
        
        localStorage.setItem('adminUI_id', data['adminUI_id']);
        localStorage.setItem('builderUI_id', data['builderUI_id']);
        
      })
    </script>

	</body>
</html>
